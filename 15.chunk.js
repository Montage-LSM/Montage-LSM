webpackJsonp([15],{224:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),u=n(2),p=n(5),f=n(7),m=n(10),d=(n(13),null),g=function(e){function t(e){a(this,t);var n=i(this,Object.getPrototypeOf(t).call(this,e));return setTimeout(function(){d=n},100),n.toggleReport=n.toggleReport.bind(n),n.ajaxToggleReportSuccess=n.ajaxToggleReportSuccess.bind(n),n.toggleVerify=n.toggleVerify.bind(n),n.ajaxToggleVerifySuccess=n.ajaxToggleVerifySuccess.bind(n),n.ajaxListSuccess=n.ajaxListSuccess.bind(n),n.ajaxPostNameSuccess=n.ajaxPostNameSuccess.bind(n),n.componentGotNotify=n.componentGotNotify.bind(n),console.log("onEnter pathname:",m.Global.get(n.props.location.pathname.substr(0,n.props.location.pathname.lastIndexOf("/")))),n.state={loading:!1,isListAll:"all"==m.Global.get(n.props.location.pathname.substr(0,n.props.location.pathname.lastIndexOf("/"))).postID,tableConfig:{total:0,pageSize:10,pageIndex:0},tableData:[],testData:"testData",tableColumns:function(e){return[{title:"评论内容预览",dataIndex:"content",key:"content",render:function(e,t){return s["default"].createElement(p.Link,{to:"/circle/comments/"+t.commentID,title:"点击浏览属于此帖子的评论列表",activeClassName:"active"},e.substr(0,20))}},{title:"发帖人",dataIndex:"creator",key:"creator"},{title:"回复给",dataIndex:"toCommentId",key:"toCommentId",render:function(e,t){return s["default"].createElement(p.Link,{to:"/circle/comments/"+t.toCommentId,title:"点击浏览属于此评论的列表",activeClassName:"active"},e)}},{title:"创建时间",dataIndex:"createdTime",key:"createdTime"},{title:"图片数量",dataIndex:"pictures",key:"pictures",render:function(e,t){return s["default"].createElement("span",null,t.pictures.length)}},{title:"审核状态",dataIndex:"isVerify",key:"isVerify",render:function(t,n){return function(){return[function(){return s["default"].createElement(u.Badge,{dot:!0},s["default"].createElement(u.Button,{type:"primary",onClick:function(){e.showUpdateVerifyConfirm(n.commentID,n.content)}},"待审核"))}(),s["default"].createElement(u.Tag,{style:{backgroundColor:"#87d068"}},"通过审核"),s["default"].createElement(u.Tag,{style:{backgroundColor:"#FAC450"}},"审核不通过")][parseInt(n.isVerify)]}()}},{title:"举报状态",dataIndex:"isReport",key:"isReport",render:function(t,n){return function(){return[s["default"].createElement(u.Tag,{style:{backgroundColor:"#ddd"}},"无举报"),function(){return s["default"].createElement(u.Badge,{dot:!0},s["default"].createElement(u.Button,{type:"primary",onClick:function(){e.showUpdateReportConfirm(n.commentID,n.content)}},"等待处理"))}(),s["default"].createElement(u.Tag,{style:{backgroundColor:"#87d068"}},"已处理（合规）"),s["default"].createElement(u.Tag,{style:{backgroundColor:"#FAC450"}},"已处理（违规）")][parseInt(n.isReport)]}()}},{title:"操作",key:"operation",render:function(t,n){return console.log("pathname!",e.props.location.pathname),console.log("pathname!",e.props.location.pathname.substr(0,e.props.location.pathname.lastIndexOf("/"))),s["default"].createElement("span",null,s["default"].createElement(p.Link,{to:"/circle/comments/"+m.Global.get(e.props.location.pathname.substr(0,e.props.location.pathname.lastIndexOf("/"))).postID+"/detail/"+n.commentID,activeClassName:"active"},s["default"].createElement(u.Icon,{type:"setting"}),"详细信息"))}}]}(n)},n}return r(t,e),c(t,[{key:"componentWillReceiveProps",value:function(){try{this.props.brodcast(m.Global.get(this.props.location.pathname.substr(0,this.props.location.pathname.lastIndexOf("/"))).postID)}catch(e){}}},{key:"showUpdateVerifyConfirm",value:function(e,t){!function(n){u.Modal.confirm({title:"该评论内容尚未经审核，请确认",content:"评论内容："+t,cancelText:"审核不通过（合规）",okText:"审核通过（违规）",width:600,onOk:function(){n.toggleVerify(e,1)},onCancel:function(){n.toggleVerify(e,2)}})}(this)}},{key:"ajaxToggleVerifySuccess",value:function(e){0==e.rc?(u.message.success(e.des),this.getList()):u.message.error(e.des)}},{key:"toggleVerify",value:function(e,t){f.PRO_REQUEST.ajax.requestData(f.PRO_URL.circles.comment.update_verify,{postID:e,status:t},this.ajaxToggleVerifySuccess,function(){return u.message.error("抱歉,审核该评论状态时遇到错误！",5)})}},{key:"showUpdateReportConfirm",value:function(e,t){!function(n){u.Modal.confirm({title:"该评论被用户举报，请确认处理结果",content:"评论内容："+t,cancelText:"举报不通过（合规）",okText:"举报通过（违规）",width:600,onOk:function(){n.toggleReport(e,1)},onCancel:function(){n.toggleReport(e,3)}})}(this)}},{key:"ajaxToggleReportSuccess",value:function(e){0==e.rc?(u.message.success(e.des),this.getList()):u.message.error(e.des)}},{key:"ajaxToggleReportError",value:function(){u.message.error("抱歉,设置该评论举报状态时遇到错误！",5)}},{key:"toggleReport",value:function(e,t){f.PRO_REQUEST.ajax.requestData(f.PRO_URL.circles.comment.update_report,{commentID:e,reportStatus:t},this.ajaxToggleReportSuccess,this.ajaxToggleReportError)}},{key:"ajaxCircleNameSuccess",value:function(e){this.setState({ownerCircleName:e.title}),this.forceUpdate()}},{key:"ajaxListSuccess",value:function(e){var e={rc:"0",des:"返回成功",pageIndex:"0",countNo:"100",list:[{commentID:"1001",creator:"1001",toCommentId:"1001",content:"评论内容评论内容评论内容评论内容1",pictures:["http://image.qiluyidian.mobi/1463042855113.jpg","http://image.qiluyidian.mobi/1463042855113.jpg","http://image.qiluyidian.mobi/1463042855113.jpg"],subCommentsCount:"10",createdTime:"2016-5-13 17:01:48",isVerify:"0",isReport:"0",reportCount:70},{commentID:"1002",creator:"1002",toCommentId:"1002",content:"评论内容评论内容评论内容评论内容2",pictures:["http://image.qiluyidian.mobi/1463042855113.jpg","http://image.qiluyidian.mobi/1463042855113.jpg","http://image.qiluyidian.mobi/1463042855113.jpg"],subCommentsCount:"100",createdTime:"2016-5-13 17:01:48",isVerify:"1",isReport:"1",reportCount:90},{commentID:"1003",creator:"1003",toCommentId:"1003",content:"评论内容评论内容评论内容评论内容3",pictures:["http://image.qiluyidian.mobi/1463042855113.jpg","http://image.qiluyidian.mobi/1463042855113.jpg","http://image.qiluyidian.mobi/1463042855113.jpg"],subCommentsCount:"100",createdTime:"2016-5-13 17:01:48",isVerify:"2",isReport:"2",reportCount:90},{commentID:"1004",creator:"1004",toCommentId:"1004",content:"评论内容评论内容评论内容评论内容4",pictures:["http://image.qiluyidian.mobi/1463042855113.jpg","http://image.qiluyidian.mobi/1463042855113.jpg","http://image.qiluyidian.mobi/1463042855113.jpg"],subCommentsCount:"100",createdTime:"2016-5-13 17:01:48",isVerify:"2",isReport:"3",reportCount:100}]};f.PRO_COMMON.obj.refsKeyTo(e.list,""),this.setState({tableData:e.list})}},{key:"ajaxPostNameSuccess",value:function(e){this.setState({ownerPostName:e.content}),this.forceUpdate()}},{key:"getCircleName",value:function(){f.PRO_REQUEST.ajax.requestData(f.PRO_URL.circles.post.get_detail,{postID:m.Global.get(this.props.location.pathname.substr(0,this.props.location.pathname.lastIndexOf("/"))).postID},this.ajaxPostNameSuccess)}},{key:"getList",value:function(){f.PRO_REQUEST.ajax.requestData(f.PRO_URL.circles.comment.get_list,this.get_list_data,this.ajaxListSuccess)}},{key:"componentDidMount",value:function(){this.getList(),this.getCircleName()}},{key:"componentGotNotify",value:function(e){d.setState({testData:e})}},{key:"render",value:function(){return this.props.children||s["default"].createElement("div",null,s["default"].createElement(u.Table,{columns:this.state.tableColumns,dataSource:this.state.tableData,expandedRowRender:function(e){return s["default"].createElement("p",null,e.content)},pagination:this.pagination}),this.state.testData)}},{key:"pagination",get:function(){return function(e){return{total:e.state.tableData.countNo,showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:function(t,n){e.state.tableConfig.pageSize=n,e.state.tableConfig.pageIndex=t-1,e.getList()},onChange:function(t){e.state.tableConfig.pageIndex=t-1,e.getList()}}}(this)}},{key:"get_list_data",get:function(){var e=m.Global.get(this.props.location.pathname.substr(0,this.props.location.pathname.lastIndexOf("/"))).postID;return this.state.isListAll||"all"==e?{pageSize:this.state.tableConfig.pageSize,pageIndex:this.state.tableConfig.pageIndex}:{circleID:e,pageSize:this.state.tableConfig.pageSize,pageIndex:this.state.tableConfig.pageIndex}}}]),t}(l.Component);g.defaultProps={componentGotNotify:function(e){return g.prototype.componentGotNotify(e)}},e.exports=g},225:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l);n(2),n(5);e.exports=function(e){function t(){return a(this,t),i(this,Object.getPrototypeOf(t).apply(this,arguments))}return r(t,e),c(t,[{key:"render",value:function(){return s["default"].createElement("div",null,"需求与疑问请向技术部提出")}}]),t}(l.Component)},226:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),s=o(l),u=n(2),p=n(5),f=n(13),m=n(10),d=function(e){function t(e){a(this,t);var n=i(this,Object.getPrototypeOf(t).call(this,e));return n.changeCircle=n.changeCircle.bind(n),n.changePost=n.changePost.bind(n),n.createComment=n.createComment.bind(n),n.toAllCommentList=n.toAllCommentList.bind(n),n.componentGotNotify=n.componentGotNotify.bind(n),n.state={selectedCircleID:"0",ownerCircleName:"默认",ownerPostId:"",ownerPostName:"请先选择圈子"},n}return r(t,e),c(t,[{key:"changeCircle",value:function(e){console.log("changeCircle"),this.setState({selectedCircleID:e}),this.forceUpdate()}},{key:"changePost",value:function(e){this.props.broadcast(e)}},{key:"createComment",value:function(){p.hashHistory.push("/circle/comments/all/detail/new")}},{key:"toAllCommentList",value:function(){console.log("toAllCommentLis"),this.props.broadcast("toAllCommentLis")}},{key:"componentGotNotify",value:function(e){console.log("componentGotNotify：",e)}},{key:"render",value:function(){return s["default"].createElement(m.TopBar,{handleSubmit:this.toAllCommentList},s["default"].createElement(u.Button,{onClick:this.createComment},"新建评论"),s["default"].createElement(u.Button,{onClick:this.toAllCommentList},"所有评论"),s["default"].createElement(f.SelectorCircle,{id:"circleOwner",isMultiple:!1,cbReceiver:this.changePost,initialValue:this.state.ownerCircleName,labelInBar:"所属圈子："}),s["default"].createElement(f.SelectorPostInCircle,{id:"postOwner",isMultiple:!1,cbReceiver:this.changePost,ownerCircleID:this.state.selectedCircleID,initialValue:this.state.ownerPostName,labelInBar:"所属贴子："}),s["default"].createElement(u.Badge,{count:"100"},s["default"].createElement(u.Button,{onClick:function(){}},"未处理的审核")),s["default"].createElement(u.Badge,{count:"100"},s["default"].createElement(u.Button,{onClick:function(){}},"未处理的举报")))}}]),t}(l.Component);d.defaultProps={componentGotNotify:d.prototype.componentGotNotify},e.exports=d}});